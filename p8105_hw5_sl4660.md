p8105\_hw5\_sl4660
================
Sibei Liu
2019/11/10

``` r
knitr::opts_chunk$set(set.seed(10))
```

# Problem 1

``` r
library(tidyverse)
library(ggrepel)


iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species)) %>% 
  janitor::clean_names()
```

``` r
fill_missing= function(x) {
  
  if (is.numeric(x)){
  replace_na(x,mean(x,na.rm=TRUE))
  } else if(is.character(x)){
    replace_na(x,"virginica")
  }    
}

iris_without_missing= iris_with_missing %>% 
  map(fill_missing) %>% 
  bind_cols() %>%  
  knitr::kable(digit=3)

iris_without_missing
```

| sepal\_length | sepal\_width | petal\_length | petal\_width | species    |
| ------------: | -----------: | ------------: | -----------: | :--------- |
|         5.100 |        3.500 |         1.400 |        0.200 | setosa     |
|         4.900 |        3.000 |         1.400 |        0.200 | setosa     |
|         4.700 |        3.200 |         1.300 |        0.200 | setosa     |
|         4.600 |        3.100 |         1.500 |        1.192 | setosa     |
|         5.000 |        3.600 |         1.400 |        0.200 | setosa     |
|         5.400 |        3.900 |         1.700 |        0.400 | setosa     |
|         5.819 |        3.400 |         1.400 |        0.300 | setosa     |
|         5.000 |        3.400 |         1.500 |        0.200 | setosa     |
|         4.400 |        2.900 |         1.400 |        0.200 | setosa     |
|         4.900 |        3.100 |         3.765 |        0.100 | setosa     |
|         5.400 |        3.075 |         1.500 |        0.200 | setosa     |
|         4.800 |        3.400 |         1.600 |        0.200 | setosa     |
|         5.819 |        3.075 |         1.400 |        0.100 | setosa     |
|         4.300 |        3.000 |         3.765 |        0.100 | setosa     |
|         5.819 |        4.000 |         3.765 |        0.200 | setosa     |
|         5.700 |        4.400 |         1.500 |        0.400 | setosa     |
|         5.400 |        3.900 |         1.300 |        0.400 | setosa     |
|         5.100 |        3.500 |         1.400 |        1.192 | setosa     |
|         5.700 |        3.800 |         1.700 |        0.300 | setosa     |
|         5.100 |        3.800 |         1.500 |        1.192 | setosa     |
|         5.400 |        3.400 |         1.700 |        0.200 | setosa     |
|         5.100 |        3.700 |         1.500 |        0.400 | virginica  |
|         4.600 |        3.600 |         1.000 |        0.200 | setosa     |
|         5.819 |        3.300 |         3.765 |        0.500 | setosa     |
|         4.800 |        3.400 |         1.900 |        0.200 | virginica  |
|         5.000 |        3.000 |         3.765 |        0.200 | setosa     |
|         5.000 |        3.400 |         1.600 |        0.400 | virginica  |
|         5.200 |        3.500 |         1.500 |        0.200 | setosa     |
|         5.819 |        3.400 |         1.400 |        0.200 | setosa     |
|         4.700 |        3.200 |         1.600 |        0.200 | setosa     |
|         4.800 |        3.100 |         3.765 |        0.200 | setosa     |
|         5.400 |        3.075 |         1.500 |        0.400 | setosa     |
|         5.200 |        3.075 |         1.500 |        0.100 | setosa     |
|         5.500 |        4.200 |         1.400 |        0.200 | setosa     |
|         4.900 |        3.100 |         3.765 |        0.200 | setosa     |
|         5.000 |        3.200 |         1.200 |        0.200 | setosa     |
|         5.500 |        3.500 |         1.300 |        0.200 | setosa     |
|         4.900 |        3.600 |         1.400 |        0.100 | setosa     |
|         4.400 |        3.000 |         1.300 |        1.192 | setosa     |
|         5.100 |        3.400 |         1.500 |        0.200 | setosa     |
|         5.000 |        3.500 |         1.300 |        0.300 | setosa     |
|         4.500 |        3.075 |         1.300 |        1.192 | virginica  |
|         4.400 |        3.200 |         1.300 |        0.200 | setosa     |
|         5.000 |        3.500 |         1.600 |        0.600 | setosa     |
|         5.100 |        3.800 |         1.900 |        0.400 | setosa     |
|         4.800 |        3.000 |         1.400 |        0.300 | virginica  |
|         5.100 |        3.800 |         1.600 |        0.200 | setosa     |
|         4.600 |        3.200 |         3.765 |        0.200 | setosa     |
|         5.300 |        3.700 |         1.500 |        0.200 | setosa     |
|         5.000 |        3.075 |         1.400 |        0.200 | setosa     |
|         7.000 |        3.075 |         4.700 |        1.400 | virginica  |
|         6.400 |        3.200 |         4.500 |        1.500 | versicolor |
|         6.900 |        3.100 |         4.900 |        1.500 | versicolor |
|         5.500 |        2.300 |         4.000 |        1.300 | versicolor |
|         6.500 |        2.800 |         4.600 |        1.500 | versicolor |
|         5.700 |        2.800 |         4.500 |        1.300 | versicolor |
|         6.300 |        3.300 |         4.700 |        1.600 | virginica  |
|         4.900 |        2.400 |         3.765 |        1.000 | versicolor |
|         6.600 |        2.900 |         4.600 |        1.300 | virginica  |
|         5.200 |        2.700 |         3.900 |        1.400 | versicolor |
|         5.000 |        2.000 |         3.765 |        1.000 | versicolor |
|         5.900 |        3.000 |         4.200 |        1.500 | versicolor |
|         6.000 |        2.200 |         4.000 |        1.192 | versicolor |
|         6.100 |        2.900 |         4.700 |        1.400 | versicolor |
|         5.600 |        2.900 |         3.600 |        1.300 | versicolor |
|         6.700 |        3.100 |         4.400 |        1.400 | versicolor |
|         5.600 |        3.000 |         4.500 |        1.500 | versicolor |
|         5.800 |        3.075 |         4.100 |        1.000 | versicolor |
|         6.200 |        2.200 |         4.500 |        1.500 | versicolor |
|         5.600 |        2.500 |         3.900 |        1.100 | versicolor |
|         5.900 |        3.200 |         4.800 |        1.800 | versicolor |
|         5.819 |        2.800 |         4.000 |        1.300 | virginica  |
|         6.300 |        2.500 |         4.900 |        1.500 | versicolor |
|         5.819 |        2.800 |         3.765 |        1.200 | versicolor |
|         6.400 |        2.900 |         4.300 |        1.300 | versicolor |
|         6.600 |        3.000 |         4.400 |        1.400 | versicolor |
|         6.800 |        2.800 |         4.800 |        1.400 | versicolor |
|         6.700 |        3.075 |         5.000 |        1.192 | versicolor |
|         6.000 |        3.075 |         4.500 |        1.192 | versicolor |
|         5.700 |        2.600 |         3.500 |        1.000 | virginica  |
|         5.500 |        2.400 |         3.800 |        1.100 | versicolor |
|         5.819 |        2.400 |         3.700 |        1.000 | versicolor |
|         5.800 |        2.700 |         3.900 |        1.200 | versicolor |
|         6.000 |        2.700 |         5.100 |        1.600 | versicolor |
|         5.400 |        3.000 |         4.500 |        1.500 | versicolor |
|         5.819 |        3.400 |         4.500 |        1.600 | versicolor |
|         6.700 |        3.100 |         4.700 |        1.192 | versicolor |
|         5.819 |        3.075 |         4.400 |        1.300 | versicolor |
|         5.600 |        3.000 |         3.765 |        1.192 | versicolor |
|         5.500 |        2.500 |         4.000 |        1.192 | versicolor |
|         5.500 |        3.075 |         4.400 |        1.200 | versicolor |
|         5.819 |        3.075 |         4.600 |        1.192 | versicolor |
|         5.800 |        3.075 |         4.000 |        1.192 | versicolor |
|         5.000 |        2.300 |         3.300 |        1.192 | virginica  |
|         5.819 |        2.700 |         4.200 |        1.300 | versicolor |
|         5.700 |        3.000 |         4.200 |        1.200 | versicolor |
|         5.700 |        2.900 |         4.200 |        1.300 | versicolor |
|         6.200 |        2.900 |         4.300 |        1.300 | versicolor |
|         5.100 |        2.500 |         3.000 |        1.192 | versicolor |
|         5.700 |        2.800 |         4.100 |        1.300 | virginica  |
|         6.300 |        3.075 |         3.765 |        2.500 | virginica  |
|         5.800 |        2.700 |         5.100 |        1.900 | virginica  |
|         7.100 |        3.000 |         5.900 |        2.100 | virginica  |
|         6.300 |        2.900 |         5.600 |        1.800 | virginica  |
|         6.500 |        3.075 |         5.800 |        2.200 | virginica  |
|         7.600 |        3.000 |         6.600 |        2.100 | virginica  |
|         4.900 |        2.500 |         4.500 |        1.700 | virginica  |
|         7.300 |        2.900 |         6.300 |        1.800 | virginica  |
|         6.700 |        3.075 |         3.765 |        1.800 | virginica  |
|         5.819 |        3.600 |         3.765 |        2.500 | virginica  |
|         6.500 |        3.200 |         5.100 |        2.000 | virginica  |
|         5.819 |        2.700 |         5.300 |        1.900 | virginica  |
|         6.800 |        3.000 |         5.500 |        2.100 | virginica  |
|         5.700 |        3.075 |         5.000 |        2.000 | virginica  |
|         5.800 |        2.800 |         5.100 |        2.400 | virginica  |
|         6.400 |        3.200 |         5.300 |        2.300 | virginica  |
|         6.500 |        3.000 |         3.765 |        1.800 | virginica  |
|         7.700 |        3.800 |         6.700 |        1.192 | virginica  |
|         7.700 |        2.600 |         6.900 |        2.300 | virginica  |
|         6.000 |        2.200 |         5.000 |        1.500 | virginica  |
|         5.819 |        3.200 |         5.700 |        1.192 | virginica  |
|         5.600 |        3.075 |         4.900 |        2.000 | virginica  |
|         7.700 |        2.800 |         6.700 |        2.000 | virginica  |
|         6.300 |        2.700 |         4.900 |        1.800 | virginica  |
|         6.700 |        3.300 |         5.700 |        2.100 | virginica  |
|         7.200 |        3.200 |         6.000 |        1.800 | virginica  |
|         6.200 |        2.800 |         4.800 |        1.800 | virginica  |
|         6.100 |        3.000 |         4.900 |        1.800 | virginica  |
|         6.400 |        2.800 |         5.600 |        2.100 | virginica  |
|         7.200 |        3.000 |         5.800 |        1.600 | virginica  |
|         7.400 |        2.800 |         6.100 |        1.192 | virginica  |
|         7.900 |        3.800 |         3.765 |        2.000 | virginica  |
|         6.400 |        2.800 |         3.765 |        2.200 | virginica  |
|         5.819 |        2.800 |         5.100 |        1.500 | virginica  |
|         6.100 |        3.075 |         5.600 |        1.400 | virginica  |
|         5.819 |        3.000 |         6.100 |        2.300 | virginica  |
|         5.819 |        3.400 |         5.600 |        1.192 | virginica  |
|         6.400 |        3.100 |         5.500 |        1.192 | virginica  |
|         6.000 |        3.000 |         4.800 |        1.800 | virginica  |
|         6.900 |        3.100 |         5.400 |        2.100 | virginica  |
|         6.700 |        3.100 |         5.600 |        2.400 | virginica  |
|         6.900 |        3.100 |         5.100 |        2.300 | virginica  |
|         5.819 |        2.700 |         5.100 |        1.900 | virginica  |
|         6.800 |        3.200 |         3.765 |        2.300 | virginica  |
|         6.700 |        3.300 |         3.765 |        2.500 | virginica  |
|         6.700 |        3.000 |         5.200 |        2.300 | virginica  |
|         6.300 |        2.500 |         5.000 |        1.900 | virginica  |
|         6.500 |        3.000 |         5.200 |        2.000 | virginica  |
|         5.819 |        3.400 |         5.400 |        2.300 | virginica  |
|         5.900 |        3.000 |         5.100 |        1.800 | virginica  |

The table after filling missing values is shown above
